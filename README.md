
<!-- README.md is generated from README.Rmd. Please edit that file -->

# dtms - An R package for discrete-time multistate models

<!-- badges: start -->
<!-- badges: end -->

## Authors

Christian Dudel, <dudel@demogr.mpg.de>

Peng Li, <li@demogr.mpg.de>

## Overview

The package dtms is a user-friendly implementation of discrete-time
multistate models in R. It comes with many tools to analyze the results
of multistate models. In particular, the worklfow mainly consists of
estimating a discrete-time multistate model and then applying methods
for absorbing Markov chains. Discrete-time multistate models lend
themselves well for modelling trajectories captured in panel data.

## Disclaimer

This package is still undergoing development and many functions are
still experimental. The content of this repository will likely change in
the future, and functions and features might be added or removed without
warning.

## Installation

You can install the development version of dtms like this:

``` r
library(devtools)
install_github("christiandudel/dtms")
```

## Example 1: Artificial data

This is a very basic example using artificial data provided with the
package. The state space consists of two transient states (A, B), and
one absorbing state (X). The time scale goes from 0 to 20. Transition
probabilities do change depending on time.

``` r
## Load package
library(dtms)

## Define model: Absorbing and transient states, time scale
simple <- dtms(transient=c("A","B"),
               absorbing="X",
               timescale=0:20)

## Look at original data
head(simpledata)
#>   id time state
#> 1  2    0     A
#> 2  2    1     B
#> 3  2    2     A
#> 4  2    3     B
#> 5  2    4     A
#> 6  2    5     A

## Reshape to transition format
estdata <- dtms_format(data=simpledata,
                       dtms=simple,
                       idvar="id",
                       timevar="time",
                       statevar="state")
#> Kept original name for time 
#> Kept original name for id

## Look at reshaped data
head(estdata)
#>   id time from to
#> 1  2    0    A  B
#> 2  2    1    B  A
#> 3  2    2    A  B
#> 4  2    3    B  A
#> 5  2    4    A  A
#> 6  2    5    A  B

## Clean
estdata <- dtms_clean(data=estdata,
                      dtms=simple)
#> Dropping  0  rows not in time range
#> Dropping  1215  rows starting or ending in NA
#> Dropping  0  rows starting in absorbing state

# Fit model 
fit <- dtms_fit(data=estdata)

## Predict probabilities
probs    <- dtms_transitions(dtms=simple,
                             model = fit)

## Get transition matrix 
Tp <- dtms_matrix(dtms=simple,
                  probs=probs)

## Get starting distribution 
S <- dtms_start(dtms=simple,
                data=estdata)

## State expectancies 
dtms_expectancy(dtms=simple,
                matrix=Tp,
                start_distr=S)
#>                  A        B    TOTAL
#> start:A_0 5.015765 8.514421 13.53019
#> start:B_0 4.799698 8.711435 13.51113
#> AVERAGE   4.905684 8.614794 13.52048

## Lifetime risk 
dtms_risk(dtms=simple,
          matrix=Tp,
          risk="A")
#>       A_0       B_0 
#> 1.0000000 0.9846722

## Distribution of visits
dtms_visits(dtms=simple,
            matrix=Tp,
            risk="A",
            start_distr=S)
#>                          0        0.5          1        1.5          2
#> start:A_0      0.000000000 0.02139860 0.00000000 0.04556435 0.00000000
#> start:B_0      0.015327809 0.00000000 0.03727791 0.00000000 0.07359658
#> AVERAGE        0.007809115 0.01049658 0.01899212 0.02235051 0.03749552
#> AVERAGE(COND.) 0.015327809 0.00000000 0.03727791 0.00000000 0.07359658
#>                         2.5          3        3.5          4           4.5
#> start:A_0      8.732850e-02 0.00000000 0.14249972 0.00000000  1.894252e-01
#> start:B_0      2.775558e-17 0.12565518 0.00000000 0.17717692 -5.551115e-17
#> AVERAGE        4.283692e-02 0.06401801 0.06989986 0.09026698  9.291803e-02
#> AVERAGE(COND.) 2.775558e-17 0.12565518 0.00000000 0.17717692 -5.551115e-17
#>                            5       5.5             6           6.5          7
#> start:A_0      -1.110223e-16 0.1989227 -1.110223e-16  1.611155e-01 0.00000000
#> start:B_0       1.995772e-01 0.0000000  1.752243e-01 -1.110223e-16 0.11674654
#> AVERAGE         1.016793e-01 0.0975768  8.927219e-02  7.903140e-02 0.05947929
#> AVERAGE(COND.)  1.995772e-01 0.0000000  1.752243e-01 -1.110223e-16 0.11674654
#>                       7.5          8        8.5           9         9.5
#> start:A_0      0.09760683 0.00000000 0.04197567 0.000000000 0.011882873
#> start:B_0      0.00000000 0.05652125 0.00000000 0.018572979 0.000000000
#> AVERAGE        0.04787872 0.02879609 0.02059017 0.009462444 0.005828862
#> AVERAGE(COND.) 0.00000000 0.05652125 0.00000000 0.018572979 0.000000000
#>                         10        10.5           11         11.5           12
#> start:A_0      0.000000000 0.002056761 0.0000000000 0.0002100808 0.000000e+00
#> start:B_0      0.003823249 0.000000000 0.0004654104 0.0000000000 3.317334e-05
#> AVERAGE        0.001947845 0.001008895 0.0002371144 0.0001030502 1.690095e-05
#> AVERAGE(COND.) 0.003823249 0.000000000 0.0004654104 0.0000000000 3.317334e-05
#>                        12.5           13          13.5            14
#> start:A_0      1.278861e-05 0.000000e+00  4.781199e-07 -1.110223e-16
#> start:B_0      0.000000e+00 1.417303e-06 -1.110223e-16  3.736743e-08
#> AVERAGE        6.273150e-06 7.220785e-07  2.345304e-07  1.903772e-08
#> AVERAGE(COND.) 0.000000e+00 1.417303e-06 -1.110223e-16  3.736743e-08
#>                        14.5            15          15.5            16
#> start:A_0      1.128639e-08 -1.110223e-16  1.706568e-10 -1.110223e-16
#> start:B_0      0.000000e+00  6.191081e-10 -1.110223e-16  6.434520e-12
#> AVERAGE        5.536273e-09  3.154192e-10  8.371161e-11  3.278164e-12
#> AVERAGE(COND.) 0.000000e+00  6.191081e-10 -1.110223e-16  6.434520e-12
#>                         16.5            17         17.5            18
#> start:A_0       1.643796e-12 -3.330669e-16 9.992007e-15 -1.110223e-16
#> start:B_0      -2.220446e-16  4.063416e-14 0.000000e+00  2.220446e-16
#> AVERAGE         8.062122e-13  2.053866e-14 4.901342e-15  5.866652e-17
#> AVERAGE(COND.) -2.220446e-16  4.063416e-14 0.000000e+00  2.220446e-16
#>                        18.5           19         19.5            20
#> start:A_0      1.110223e-16 2.220446e-16 0.000000e+00  0.000000e+00
#> start:B_0      0.000000e+00 0.000000e+00 2.220446e-16 -2.220446e-16
#> AVERAGE        5.445936e-17 1.089187e-16 1.131259e-16 -1.131259e-16
#> AVERAGE(COND.) 0.000000e+00 0.000000e+00 2.220446e-16 -2.220446e-16
#>                         20.5
#> start:A_0      -2.220446e-16
#> start:B_0      -1.110223e-16
#> AVERAGE        -1.654817e-16
#> AVERAGE(COND.) -1.110223e-16

## First/last visit
dtms_first(dtms=simple,
           matrix=Tp,
           risk="A",
           start_distr=S)
#>                       0       0.5       1.5        2.5        3.5        4.5
#> start:A_0      1.000000 0.0000000 0.0000000 0.00000000 0.00000000 0.00000000
#> start:B_0      0.000000 0.5298969 0.2487133 0.11704870 0.05519050 0.02604746
#> AVERAGE        0.494387 0.2679227 0.1257527 0.05918134 0.02790503 0.01316994
#> AVERAGE(COND.) 0.000000 0.5298969 0.2487133 0.11704870 0.05519050 0.02604746
#>                        5.5         6.5         7.5         8.5          9.5
#> start:A_0      0.000000000 0.000000000 0.000000000 0.000000000 0.0000000000
#> start:B_0      0.012289033 0.005786386 0.002713402 0.001263733 0.0005825315
#> AVERAGE        0.006213494 0.002925672 0.001371931 0.000638960 0.0002945355
#> AVERAGE(COND.) 0.012289033 0.005786386 0.002713402 0.001263733 0.0005825315
#>                        10.5         11.5         12.5         13.5         14.5
#> start:A_0      0.0000000000 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#> start:B_0      0.0002645973 1.177700e-04 5.100991e-05 2.131786e-05 8.508056e-06
#> AVERAGE        0.0001337838 5.954603e-05 2.579127e-05 1.077858e-05 4.301783e-06
#> AVERAGE(COND.) 0.0002645973 1.177700e-04 5.100991e-05 2.131786e-05 8.508056e-06
#>                        15.5         16.5         17.5         18.5
#> start:A_0      0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#> start:B_0      3.203492e-06 1.122048e-06 3.598564e-07 1.038734e-07
#> AVERAGE        1.619727e-06 5.673221e-07 1.819480e-07 5.251973e-08
#> AVERAGE(COND.) 3.203492e-06 1.122048e-06 3.598564e-07 1.038734e-07
#>                TOTAL(RESCALED)
#> start:A_0                    1
#> start:B_0                    1
#> AVERAGE                      1
#> AVERAGE(COND.)               1

dtms_last(dtms=simple,
          matrix=Tp,
          risk="A",
          start_distr=S,
          rescale=T,
          total=F)
#>                       0.5         1.5        2.5        3.5        4.5
#> start:A_0      0.02139860 0.003165010 0.01716991 0.01512523 0.02287011
#> start:B_0      0.00000000 0.014828691 0.01124049 0.01858749 0.02150094
#> AVERAGE        0.01057919 0.009062318 0.01417192 0.01687579 0.02217784
#> AVERAGE(COND.) 0.00000000 0.014828691 0.01124049 0.01858749 0.02150094
#>                       5.5        6.5        7.5        8.5        9.5
#> start:A_0      0.02701001 0.03466032 0.04220125 0.05132105 0.06075695
#> start:B_0      0.02826202 0.03470815 0.04301741 0.05193800 0.06166635
#> AVERAGE        0.02764304 0.03468450 0.04261391 0.05163299 0.06121675
#> AVERAGE(COND.) 0.02826202 0.03470815 0.04301741 0.05193800 0.06166635
#>                      10.5       11.5       12.5       13.5       14.5
#> start:A_0      0.07033993 0.07894684 0.08551388 0.08873791 0.08758683
#> start:B_0      0.07130922 0.08007239 0.08671669 0.08999288 0.08882282
#> AVERAGE        0.07083002 0.07951593 0.08612203 0.08937244 0.08821176
#> AVERAGE(COND.) 0.07130922 0.08007239 0.08671669 0.08999288 0.08882282
#>                      15.5       16.5       17.5       18.5       19.5
#> start:A_0      0.08163513 0.07156045 0.05947112 0.04907794 0.03145157
#> start:B_0      0.08278814 0.07257081 0.06031091 0.04977093 0.03189568
#> AVERAGE        0.08221811 0.07207130 0.05989573 0.04942832 0.03167611
#> AVERAGE(COND.) 0.08278814 0.07257081 0.06031091 0.04977093 0.03189568
```

## Example 2: Simulated HRS data

Here we provide a second example based on simulated data from the Health
and Retirement Study (HRS).

``` r
## Load package
library(dtms)

## Define model: Absorbing and transient states, time scale
hrs <- dtms(transient=c("Employed","Inactive","Retired"),
            absorbing="Dead",
            timescale=50:99)

## Quick look at data
head(hrsdata)
#>   ID Gender Age State
#> 1  1      1  50  <NA>
#> 2  1      1  51  <NA>
#> 3  1      1  52  <NA>
#> 4  1      1  53  <NA>
#> 5  1      1  54  <NA>
#> 6  1      1  55  <NA>

## Reshape
estdata <- dtms_format(data=hrsdata,
                       dtms=hrs,
                       idvar="ID",
                       timevar="Age",
                       statevar="State")

## Drop dead-to-dead transitions etc
estdata <- dtms_clean(data=estdata,
                      dtms=hrs)
#> Dropping  0  rows not in time range
#> Dropping  98287  rows starting or ending in NA
#> Dropping  51935  rows starting in absorbing state

## Add age squared
estdata$time2 <- estdata$time^2
  
## Fit model
fit <- dtms_fit(data=estdata,
                controls=c("Gender","time2"))

## Transition probabilities by gender
  
# Men
probs_m <- dtms_transitions(dtms=hrs,
                             model = fit,
                             constant = list(Gender=0),
                             varying = list(time2 = (50:98)^2))
  
# Women
probs_w <- dtms_transitions(dtms=hrs,
                            model = fit,
                            constant = list(Gender=1),
                            varying = list(time2 = (50:98)^2))
 
## Transition matrices
Tm <- dtms_matrix(dtms=hrs,
                  probs=probs_m)
#> Warning in ans * length(l) + if1: longer object length is not a multiple of
#> shorter object length
  
Tw <- dtms_matrix(dtms=hrs,
                  probs=probs_w)
#> Warning in ans * length(l) + if1: longer object length is not a multiple of
#> shorter object length

## Starting distributions
Sm <- dtms_start(dtms=hrs,
                 data=estdata,
                 variables=list(Gender=0))
  
Sw <- dtms_start(dtms=hrs,
                 data=estdata,
                 variables=list(Gender=1))
  
## State expectancies
dtms_expectancy(dtms=hrs,
                matrix=Tm,
                start_distr=Sm)
#>                    Employed Inactive  Retired    TOTAL
#> start:Employed_50 13.307139 3.074605 13.53075 29.91250
#> start:Inactive_50  8.782801 6.496935 13.74458 29.02431
#> start:Retired_50   8.821583 3.905134 15.18436 27.91108
#> AVERAGE           12.445788 3.589228 13.64849 29.68351
    
dtms_expectancy(dtms=hrs,
                matrix=Tw,
                start_distr=Sw)
#>                    Employed Inactive  Retired    TOTAL
#> start:Employed_50 12.065776 4.386659 16.50506 32.95749
#> start:Inactive_50  7.444819 8.199122 16.75206 32.39600
#> start:Retired_50   7.836000 5.486704 18.21488 31.53758
#> AVERAGE           10.449871 5.607548 16.66115 32.71857

## Lifetime risk of reaching retirement
dtms_risk(dtms=hrs,
          matrix=Tm,
          risk="Retired",
          start_distr=Sm)
#>    Employed_50    Inactive_50     Retired_50        AVERAGE AVERAGE(COND.) 
#>      0.8828700      0.8806114      1.0000000      0.8888185      0.8825421
  
dtms_risk(dtms=hrs,
          matrix=Tw,
          risk="Retired",
          start_distr=Sw)
#>    Employed_50    Inactive_50     Retired_50        AVERAGE AVERAGE(COND.) 
#>      0.9172405      0.9159545      1.0000000      0.9207350      0.9168266
  
## Distribution of visits
dtms_visits(dtms=hrs,
            matrix=Tm,
            risk="Retired",
            start_distr=Sm)
#>                           0          0.5          1        1.5          2
#> start:Employed_50 0.1171300 0.000000e+00 0.03338845 0.00000000 0.03165400
#> start:Inactive_50 0.1193886 1.387779e-17 0.03551633 0.00000000 0.03265380
#> start:Retired_50  0.0000000 6.864448e-02 0.00000000 0.05126985 0.00000000
#> AVERAGE           0.1111815 3.668025e-03 0.03189671 0.00273961 0.03009994
#> AVERAGE(COND.)    0.1174579 2.014518e-18 0.03369733 0.00000000 0.03179913
#>                           2.5          3         3.5          4         4.5
#> start:Employed_50 0.000000000 0.03056157 0.000000000 0.02990815 0.000000000
#> start:Inactive_50 0.000000000 0.03085467 0.000000000 0.02973000 0.000000000
#> start:Retired_50  0.041700044 0.00000000 0.036128383 0.00000000 0.032749468
#> AVERAGE           0.002228247 0.02896878 0.001930524 0.02828552 0.001749972
#> AVERAGE(COND.)    0.000000000 0.03060411 0.000000000 0.02988229 0.000000000
#>                            5         5.5          6        6.5          7
#> start:Employed_50 0.02956825 0.000000000 0.02945868 0.00000000 0.02952005
#> start:Inactive_50 0.02905783 0.000000000 0.02870276 0.00000000 0.02857623
#> start:Retired_50  0.00000000 0.030652183 0.00000000 0.02934867 0.00000000
#> AVERAGE           0.02791814 0.001637903 0.02778068 0.00156825 0.02781296
#> AVERAGE(COND.)    0.02949416 0.000000000 0.02934895 0.00000000 0.02938304
#>                           7.5          8         8.5          9         9.5
#> start:Employed_50 0.000000000 0.02970672 0.000000000 0.02998094 0.000000000
#> start:Inactive_50 0.000000000 0.02861598 0.000000000 0.02877482 0.000000000
#> start:Retired_50  0.028562072 0.00000000 0.028125677 0.00000000 0.027932605
#> AVERAGE           0.001526218 0.02796947 0.001502899 0.02821317 0.001492582
#> AVERAGE(COND.)    0.000000000 0.02954839 0.000000000 0.02980585 0.000000000
#>                           10       10.5         11        11.5         12
#> start:Employed_50 0.03030935 0.00000000 0.03066098 0.000000000 0.03100595
#> start:Inactive_50 0.02901425 0.00000000 0.02930078 0.000000000 0.02960366
#> start:Retired_50  0.00000000 0.02790954 0.00000000 0.028002476 0.00000000
#> AVERAGE           0.02851181 0.00149135 0.02883571 0.001496316 0.02915647
#> AVERAGE(COND.)    0.03012135 0.00000000 0.03046353 0.000000000 0.03080240
#>                          12.5         13          13.5            14
#> start:Employed_50 0.000000000 0.03131492 -1.110223e-16  3.155880e-02
#> start:Inactive_50 0.000000000 0.02989369 -1.110223e-16  3.014254e-02
#> start:Retired_50  0.028168665 0.00000000  2.837203e-02 -5.551115e-17
#> AVERAGE           0.001505196 0.02944632  1.516063e-03  2.967785e-02
#> AVERAGE(COND.)    0.000000000 0.03110861 -1.110223e-16  3.135321e-02
#>                            14.5         15          15.5            16
#> start:Employed_50  0.000000e+00 0.03170890 -1.110223e-16  3.173735e-02
#> start:Inactive_50 -1.110223e-16 0.03032254  0.000000e+00  3.040678e-02
#> start:Retired_50   2.858049e-02 0.00000000  2.876445e-02 -1.110223e-16
#> AVERAGE            1.527202e-03 0.02982404  1.537032e-03  2.985863e-02
#> AVERAGE(COND.)    -1.611614e-17 0.03150766 -9.490616e-17  3.154420e-02
#>                            16.5         17        17.5         18        18.5
#> start:Employed_50  0.000000e+00 0.03161764 0.000000000 0.03132551 0.000000000
#> start:Inactive_50 -1.110223e-16 0.03036950 0.000000000 0.03018667 0.000000000
#> start:Retired_50   2.889607e-02 0.00000000 0.028948988 0.00000000 0.028898460
#> AVERAGE            1.544065e-03 0.02975665 0.001546892 0.02949515 0.001544193
#> AVERAGE(COND.)    -1.611614e-17 0.03143646 0.000000000 0.03116020 0.000000000
#>                           19        19.5         20        20.5         21
#> start:Employed_50 0.03083987 0.000000000 0.03014393 0.000000000 0.02922636
#> start:Inactive_50 0.02983674 0.000000000 0.02930156 0.000000000 0.02856738
#> start:Retired_50  0.00000000 0.028721730 0.00000000 0.028398619 0.00000000
#> AVERAGE           0.02905411 0.001534749 0.02841744 0.001517483 0.02757410
#> AVERAGE(COND.)    0.03069426 0.000000000 0.03002165 0.000000000 0.02913070
#>                          21.5         22        22.5         23        23.5
#> start:Employed_50 0.000000000 0.02808253 0.000000000 0.02671563 0.000000000
#> start:Inactive_50 0.000000000 0.02762594 0.000000000 0.02647554 0.000000000
#> start:Retired_50  0.027912269 0.00000000 0.027250004 0.00000000 0.026404237
#> AVERAGE           0.001491495 0.02651919 0.001456107 0.02525508 0.001410913
#> AVERAGE(COND.)    0.000000000 0.02801625 0.000000000 0.02668077 0.000000000
#>                           24        24.5         25       25.5         26
#> start:Employed_50 0.02513766 0.000000000 0.02337005 0.00000000 0.02144372
#> start:Inactive_50 0.02512207 0.000000000 0.02357975 0.00000000 0.02187146
#> start:Retired_50  0.00000000 0.025373368 0.00000000 0.02416257 0.00000000
#> AVERAGE           0.02379228 0.001355829 0.02215008 0.00129113 0.02035664
#> AVERAGE(COND.)    0.02513540 0.000000000 0.02340049 0.00000000 0.02150581
#>                          26.5         27       27.5         28        28.5
#> start:Employed_50 0.000000000 0.01939821 0.00000000 0.01727984 0.000000000
#> start:Inactive_50 0.000000000 0.02002843 0.00000000 0.01808897 0.000000000
#> start:Retired_50  0.022784316 0.00000000 0.02125850 0.00000000 0.019611901
#> AVERAGE           0.001217483 0.01844826 0.00113595 0.01646767 0.001047964
#> AVERAGE(COND.)    0.000000000 0.01948970 0.00000000 0.01739730 0.000000000
#>                           29          29.5         30          30.5         31
#> start:Employed_50 0.01513895  0.000000e+00 0.01302696  0.000000e+00 0.01099363
#> start:Inactive_50 0.01609641 -1.110223e-16 0.01409670 -1.110223e-16 0.01213599
#> start:Retired_50  0.00000000  1.787704e-02 0.00000000  1.609051e-02 0.00000000
#> AVERAGE           0.01446156  9.552616e-04 0.01247785  8.597983e-04 0.01056315
#> AVERAGE(COND.)    0.01527794 -1.611614e-17 0.01318224 -1.611614e-17 0.01115945
#>                           31.5          32         32.5          33
#> start:Employed_50 0.0000000000 0.009084626 1.110223e-16 0.007338997
#> start:Inactive_50 0.0000000000 0.010258434 2.220446e-16 0.008503830
#> start:Retired_50  0.0142911232 0.000000000 1.251794e-02 0.000000000
#> AVERAGE           0.0007636478 0.008760474 6.688976e-04 0.007106890
#> AVERAGE(COND.)    0.0000000000 0.009255017 1.271384e-16 0.007508086
#>                            33.5          34         34.5          35
#> start:Employed_50  0.000000e+00 0.005786582 0.0000000000 0.004445851
#> start:Inactive_50 -2.220446e-16 0.006905141 0.0000000000 0.005486242
#> start:Retired_50   1.080827e-02 0.000000000 0.0091955555 0.000000000
#> AVERAGE            5.775413e-04 0.005631070 0.0004913656 0.004351241
#> AVERAGE(COND.)    -3.223228e-17 0.005948953 0.0000000000 0.004596875
#>                           35.5          36         36.5          37
#> start:Employed_50 0.0000000000 0.003322849 0.0000000000 0.002411659
#> start:Inactive_50 0.0000000000 0.004260435 0.0000000000 0.003230194
#> start:Retired_50  0.0077073007 0.000000000 0.0063634513 0.000000000
#> AVERAGE           0.0004118405 0.003274121 0.0003400318 0.002395262
#> AVERAGE(COND.)    0.0000000000 0.003458950 0.0000000000 0.002530479
#>                           37.5           38        38.5          39
#> start:Employed_50 1.110223e-16 1.696298e-03 0.000000000 0.001153576
#> start:Inactive_50 1.110223e-16 2.388176e-03 0.000000000 0.001719218
#> start:Retired_50  5.175474e-03 1.110223e-16 0.004146393 0.000000000
#> AVERAGE           2.765521e-04 1.700723e-03 0.000221563 0.001169656
#> AVERAGE(COND.)    1.110223e-16 1.796732e-03 0.000000000 0.001235685
#>                           39.5           40         40.5           41
#> start:Employed_50 0.0000000000 7.563038e-04 0.0000000000 0.0004762872
#> start:Inactive_50 0.0000000000 1.202859e-03 0.0000000000 0.0008159189
#> start:Retired_50  0.0032717298 2.220446e-16 0.0025411303 0.0000000000
#> AVERAGE           0.0001748253 7.772494e-04 0.0001357856 0.0004975037
#> AVERAGE(COND.)    0.0000000000 8.211264e-04 0.0000000000 0.0005255886
#>                           41.5           42          42.5           43
#> start:Employed_50 0.0000000000 0.0002867471 -2.220446e-16 0.0001639811
#> start:Inactive_50 0.0000000000 0.0005347584 -1.110223e-16 0.0003370320
#> start:Retired_50  0.0019403650 0.0000000000  1.453357e-03 0.0000000000
#> AVERAGE           0.0001036836 0.0003055026  7.766032e-05 0.0001789967
#> AVERAGE(COND.)    0.0000000000 0.0003227487 -2.059285e-16 0.0001891014
#>                           43.5           44         44.5           45
#> start:Employed_50 0.000000e+00 8.826685e-05 0.0000000000 4.411016e-05
#> start:Inactive_50 0.000000e+00 2.028437e-04 0.0000000000 1.153497e-04
#> start:Retired_50  1.063954e-03 0.000000e+00 0.0007572156 0.000000e+00
#> AVERAGE           5.685251e-05 9.929369e-05 0.0000404619 5.154176e-05
#> AVERAGE(COND.)    0.000000e+00 1.048990e-04 0.0000000000 5.445138e-05
#>                            45.5            46         46.5           47
#> start:Employed_50 -2.220446e-16  2.000402e-05 3.330669e-16 7.879606e-06
#> start:Inactive_50 -1.110223e-16  6.090871e-05 2.220446e-16 2.891310e-05
#> start:Retired_50   5.201112e-04 -2.220446e-16 3.416419e-04 0.000000e+00
#> AVERAGE            2.779220e-05  2.455560e-05 1.825567e-05 1.034866e-05
#> AVERAGE(COND.)    -2.059285e-16  2.594180e-05 3.169508e-16 1.093285e-05
#>                           47.5           48          48.5            49
#> start:Employed_50 0.000000e+00 2.412467e-06 -2.220446e-16  0.000000e+00
#> start:Inactive_50 0.000000e+00 1.141842e-05  0.000000e+00  0.000000e+00
#> start:Retired_50  2.127848e-04 1.110223e-16  1.925212e-04 -2.220446e-16
#> AVERAGE           1.137018e-05 3.521016e-06  1.028739e-05 -1.186498e-17
#> AVERAGE(COND.)    0.000000e+00 3.719783e-06 -1.898123e-16  0.000000e+00
#>                           49.5
#> start:Employed_50 0.000000e+00
#> start:Inactive_50 0.000000e+00
#> start:Retired_50  2.220446e-16
#> AVERAGE           1.186498e-17
#> AVERAGE(COND.)    0.000000e+00
  
dtms_visits(dtms=hrs,
            matrix=Tw,
            risk="Retired",
            start_distr=Sw,
            method="end")
#>                            0             1          2          3          4
#> start:Employed_50 0.08275955  0.000000e+00 0.02446359 0.02331318 0.02267940
#> start:Inactive_50 0.08404550 -1.387779e-17 0.02580474 0.02396753 0.02289828
#> start:Retired_50  0.00000000  4.940366e-02 0.03703364 0.03034240 0.02655296
#> AVERAGE           0.07926497  2.321524e-03 0.02546557 0.02384416 0.02292855
#> AVERAGE(COND.)    0.08317336 -4.465863e-18 0.02489517 0.02352375 0.02274984
#>                            5          6          7          8          9
#> start:Employed_50 0.02240828 0.02240784 0.02261977 0.02300464 0.02353366
#> start:Inactive_50 0.02233017 0.02211278 0.02215617 0.02240317 0.02281492
#> start:Retired_50  0.02435729 0.02310129 0.02243892 0.02217696 0.02220148
#> AVERAGE           0.02247591 0.02234994 0.02246910 0.02278129 0.02325064
#> AVERAGE(COND.)    0.02238314 0.02231289 0.02247059 0.02281109 0.02330237
#>                           10         11         12         13         14
#> start:Employed_50 0.02418394 0.02493545 0.02576902 0.02666502 0.02760228
#> start:Inactive_50 0.02336281 0.02402377 0.02477738 0.02560390 0.02648297
#> start:Retired_50  0.02244130 0.02284880 0.02338949 0.02403598 0.02476434
#> AVERAGE           0.02385023 0.02455780 0.02535309 0.02621605 0.02712566
#> AVERAGE(COND.)    0.02391970 0.02464207 0.02544991 0.02632355 0.02724209
#>                           15         16         17         18         19
#> start:Employed_50 0.02855747 0.02950453 0.03041446 0.03125527 0.03199221
#> start:Inactive_50 0.02739270 0.02830899 0.02920513 0.03005165 0.03081634
#> start:Retired_50  0.02555185 0.02637545 0.02721086 0.02803190 0.02881029
#> AVERAGE           0.02805902 0.02899084 0.02989305 0.03073468 0.03148207
#> AVERAGE(COND.)    0.02818265 0.02911980 0.03002530 0.03086794 0.03161381
#>                           20         21         22         23         24
#> start:Employed_50 0.03258832 0.03300536 0.03320515 0.03315138 0.03281209
#> start:Inactive_50 0.03146462 0.03196024 0.03226633 0.03234694 0.03216915
#> start:Retired_50  0.02951556 0.03011541 0.03057636 0.03086471 0.03094803
#> AVERAGE           0.03209931 0.03254905 0.03279370 0.03279722 0.03252732
#> AVERAGE(COND.)    0.03222671 0.03266905 0.03290304 0.03289251 0.03260519
#>                           25         26         27         28         29
#> start:Employed_50 0.03216257 0.03118845 0.02988779 0.02827096 0.02635877
#> start:Inactive_50 0.03170570 0.03093793 0.02985801 0.02846940 0.02678551
#> start:Retired_50  0.03079711 0.03038818 0.02970511 0.02874068 0.02749672
#> AVERAGE           0.03195830 0.03107402 0.02987007 0.02835389 0.02654311
#> AVERAGE(COND.)    0.03201555 0.03110783 0.02987820 0.02833481 0.02649609
#>                           30         31         32         33         34
#> start:Employed_50 0.02418157 0.02178195 0.01921955 0.01657327 0.01393676
#> start:Inactive_50 0.02482891 0.02263346 0.02024877 0.01774301 0.01520029
#> start:Retired_50  0.02598389 0.02422257 0.02224520 0.02009870 0.01784429
#> AVERAGE           0.02446479 0.02215778 0.01967737 0.01709767 0.01450788
#> AVERAGE(COND.)    0.02438989 0.02205597 0.01955075 0.01694969 0.01434336
#>                           35          36          37          38          39
#> start:Employed_50 0.01140757 0.009073858 0.007003207 0.005236357 0.003786377
#> start:Inactive_50 0.01271202 0.010365284 0.008231970 0.006361694 0.004779304
#> start:Retired_50  0.01555368 0.013302026 0.011159651 0.009184792 0.007418791
#> AVERAGE           0.01200245 0.009668595 0.007575356 0.005767013 0.004261576
#> AVERAGE(COND.)    0.01182734 0.009489438 0.007398622 0.005598490 0.004105900
#>                            40          41          42           43           44
#> start:Employed_50 0.002642174 0.001774584 0.001143319 0.0007035042 0.0004109874
#> start:Inactive_50 0.003486504 0.002466255 0.001688505 0.0011160234 0.0007094946
#> start:Retired_50  0.005884327 0.004586378 0.003515201 0.0026504212 0.0019654289
#> AVERAGE           0.003053463 0.002118833 0.001421972 0.0009215020 0.0005755775
#> AVERAGE(COND.)    0.002913879 0.001997163 0.001318760 0.0008362526 0.0005070468
#>                             45           46           47           48
#> start:Employed_50 0.0002260680 0.0001156258 5.385538e-05 2.194196e-05
#> start:Inactive_50 0.0004314232 0.0002486803 1.337895e-04 6.518272e-05
#> start:Retired_50  0.0014314397 0.0010207935 7.093414e-04 4.786617e-04
#> AVERAGE           0.0003456874 0.0001989653 1.091713e-04 5.666462e-05
#> AVERAGE(COND.)    0.0002921511 0.0001584427 7.957814e-05 3.585681e-05
#>                             49            50
#> start:Employed_50 7.060355e-06 -2.220446e-16
#> start:Inactive_50 2.670889e-05  0.000000e+00
#> start:Retired_50  5.276947e-04  2.220446e-16
#> AVERAGE           3.755122e-05 -1.330803e-16
#> AVERAGE(COND.)    1.338324e-05 -1.505908e-16
  
## First visit
dtms_first(dtms=hrs,
           matrix=Tm,
           risk="Retired",
           start_distr=Sm)  
#>                            0         0.5        1.5        2.5        3.5
#> start:Employed_50 0.00000000 0.008510551 0.01176588 0.01526444 0.01906744
#> start:Inactive_50 0.00000000 0.040384498 0.03705685 0.03536803 0.03492557
#> start:Retired_50  1.00000000 0.000000000 0.00000000 0.00000000 0.00000000
#> AVERAGE           0.06011927 0.012338089 0.01450153 0.01708357 0.02007998
#> AVERAGE(COND.)    0.00000000 0.013127292 0.01542912 0.01817632 0.02136439
#>                          4.5        5.5        6.5        7.5        8.5
#> start:Employed_50 0.02320676 0.02768571 0.03247537 0.03750739 0.04266425
#> start:Inactive_50 0.03546315 0.03678288 0.03871845 0.04110939 0.04378161
#> start:Retired_50  0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
#> AVERAGE           0.02348012 0.02725971 0.03137288 0.03574283 0.04025142
#> AVERAGE(COND.)    0.02498202 0.02900338 0.03337964 0.03802912 0.04282609
#>                          9.5       10.5       11.5       12.5       13.5
#> start:Employed_50 0.04776870 0.05257583 0.05677318 0.05999664 0.06187033
#> start:Inactive_50 0.04653262 0.04912241 0.05127326 0.05268355 0.05306076
#> start:Retired_50  0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
#> AVERAGE           0.04472860 0.04894487 0.05261128 0.05539412 0.05695143
#> AVERAGE(COND.)    0.04758966 0.05207562 0.05597655 0.05893739 0.06059432
#>                         14.5       15.5       16.5       17.5       18.5
#> start:Employed_50 0.06207455 0.06043520 0.05700952 0.05212563 0.04633450
#> start:Inactive_50 0.05217525 0.04992730 0.04640600 0.04190717 0.03688154
#> start:Retired_50  0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
#> AVERAGE           0.05699502 0.05537138 0.05213863 0.04760078 0.04226202
#> AVERAGE(COND.)    0.06064070 0.05891320 0.05547366 0.05064555 0.04496530
#>                         19.5       20.5       21.5       22.5       23.5
#> start:Employed_50 0.04026816 0.03445914 0.02921569 0.02461588 0.02059841
#> start:Inactive_50 0.03181514 0.02709062 0.02290292 0.01927069 0.01611706
#> start:Retired_50  0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
#> AVERAGE           0.03669651 0.03138436 0.02659987 0.02240832 0.01874998
#> AVERAGE(COND.)    0.03904379 0.03339186 0.02830133 0.02384166 0.01994931
#>                         24.5       25.5        26.5        27.5        28.5
#> start:Employed_50 0.01706864 0.01395775 0.011230991 0.008872823 0.006871546
#> start:Inactive_50 0.01335305 0.01091893 0.008785762 0.006941012 0.005375457
#> start:Retired_50  0.00000000 0.00000000 0.000000000 0.000000000 0.000000000
#> AVERAGE           0.01553666 0.01270493 0.010222908 0.008076407 0.006254762
#> AVERAGE(COND.)    0.01653046 0.01351760 0.010876815 0.008593012 0.006654847
#>                          29.5        30.5        31.5        32.5        33.5
#> start:Employed_50 0.005210436 0.003864658 0.002801740 0.001983932 0.001371271
#> start:Inactive_50 0.004076008 0.003023236 0.002191738 0.001551986 0.001072714
#> start:Retired_50  0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
#> AVERAGE           0.004742752 0.003517770 0.002550258 0.001805856 0.001248187
#> AVERAGE(COND.)    0.005046121 0.003742783 0.002713385 0.001921367 0.001328027
#>                           34.5         35.5         36.5         37.5
#> start:Employed_50 0.0009245231 0.0006075356 0.0003887592 0.0002419632
#> start:Inactive_50 0.0007232337 0.0004752615 0.0003041176 0.0001892824
#> start:Retired_50  0.0000000000 0.0000000000 0.0000000000 0.0000000000
#> AVERAGE           0.0008415388 0.0005530038 0.0003538645 0.0002202448
#> AVERAGE(COND.)    0.0008953676 0.0005883765 0.0003764994 0.0002343328
#>                           38.5         39.5         40.5         41.5
#> start:Employed_50 0.0001462739 8.573963e-05 4.862724e-05 2.661725e-05
#> start:Inactive_50 0.0001144268 6.707219e-05 3.804000e-05 2.082208e-05
#> start:Retired_50  0.0000000000 0.000000e+00 0.000000e+00 0.000000e+00
#> AVERAGE           0.0001331445 7.804372e-05 4.426251e-05 2.422811e-05
#> AVERAGE(COND.)    0.0001416610 8.303577e-05 4.709375e-05 2.577786e-05
#>                           42.5         43.5         44.5         45.5
#> start:Employed_50 1.401955e-05 7.080767e-06 3.415627e-06 1.566582e-06
#> start:Inactive_50 1.096718e-05 5.539126e-06 2.671969e-06 1.225502e-06
#> start:Retired_50  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#> AVERAGE           1.276117e-05 6.445204e-06 3.109044e-06 1.425967e-06
#> AVERAGE(COND.)    1.357743e-05 6.857470e-06 3.307913e-06 1.517179e-06
#>                           46.5         47.5 TOTAL(RESCALED)
#> start:Employed_50 6.797764e-07 2.775573e-07               1
#> start:Inactive_50 5.317739e-07 2.171269e-07               1
#> start:Retired_50  0.000000e+00 0.000000e+00               1
#> AVERAGE           6.187603e-07 2.526440e-07               1
#> AVERAGE(COND.)    6.583392e-07 2.688043e-07               1
  
dtms_first(dtms=hrs,
           matrix=Tw,
           risk="Retired",
           start_distr=Sw)  
#>                            0         0.5        1.5        2.5        3.5
#> start:Employed_50 0.00000000 0.008543757 0.01175132 0.01520147 0.01894215
#> start:Inactive_50 0.00000000 0.032365881 0.03116009 0.03099414 0.03168189
#> start:Retired_50  1.00000000 0.000000000 0.00000000 0.00000000 0.00000000
#> AVERAGE           0.05103632 0.015375496 0.01707291 0.01924375 0.02186212
#> AVERAGE(COND.)    0.00000000 0.016202408 0.01799111 0.02027871 0.02303789
#>                          4.5        5.5        6.5        7.5        8.5
#> start:Employed_50 0.02300192 0.02739042 0.03209511 0.03707431 0.04224656
#> start:Inactive_50 0.03309104 0.03511678 0.03766292 0.04062628 0.04388199
#> start:Retired_50  0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
#> AVERAGE           0.02490603 0.02834971 0.03215575 0.03626582 0.04058940
#> AVERAGE(COND.)    0.02624550 0.02987439 0.03388513 0.03821624 0.04277234
#>                          9.5       10.5       11.5       12.5       13.5
#> start:Employed_50 0.04747706 0.05256289 0.05722147 0.06108921 0.06374106
#> start:Inactive_50 0.04726906 0.05057716 0.05353778 0.05582563 0.05707859
#> start:Retired_50  0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
#> AVERAGE           0.04499054 0.04927446 0.05317726 0.05636560 0.05845533
#> AVERAGE(COND.)    0.04741019 0.05192449 0.05603719 0.05939701 0.06159912
#>                         14.5       15.5       16.5       17.5       18.5
#> start:Employed_50 0.06474218 0.06373837 0.06057602 0.05541516 0.04877345
#> start:Inactive_50 0.05694475 0.05515992 0.05164535 0.04659268 0.04048424
#> start:Retired_50  0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
#> AVERAGE           0.05905909 0.05786824 0.05475983 0.04989536 0.04375531
#> AVERAGE(COND.)    0.06223536 0.06098046 0.05770487 0.05257879 0.04610852
#>                         19.5       20.5       21.5       22.5       23.5
#> start:Employed_50 0.04144050 0.03425935 0.02786711 0.02254152 0.01823599
#> start:Inactive_50 0.03400332 0.02784071 0.02248284 0.01810249 0.01460971
#> start:Retired_50  0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
#> AVERAGE           0.03705656 0.03055265 0.02480221 0.02003680 0.01619897
#> AVERAGE(COND.)    0.03904950 0.03219580 0.02613610 0.02111440 0.01707017
#>                         24.5        25.5        26.5        27.5        28.5
#> start:Employed_50 0.01474438 0.011858851 0.009438700 0.007404906 0.005711551
#> start:Inactive_50 0.01180073 0.009488268 0.007551315 0.005924116 0.004569379
#> start:Retired_50  0.00000000 0.000000000 0.000000000 0.000000000 0.000000000
#> AVERAGE           0.01309382 0.010530389 0.008381170 0.006575219 0.005071594
#> AVERAGE(COND.)    0.01379802 0.011096725 0.008831918 0.006928842 0.005344350
#>                          29.5        30.5        31.5        32.5         33.5
#> start:Employed_50 0.004324293 0.003210304 0.002335277 0.001663703 0.0011603683
#> start:Inactive_50 0.003459539 0.002568321 0.001868278 0.001331002 0.0009283226
#> start:Retired_50  0.000000000 0.000000000 0.000000000 0.000000000 0.0000000000
#> AVERAGE           0.003839773 0.002850602 0.002073619 0.001477291 0.0010303536
#> AVERAGE(COND.)    0.004046281 0.003003911 0.002185140 0.001556742 0.0010857672
#>                           34.5         35.5         36.5         37.5
#> start:Employed_50 0.0007920612 0.0005289541 0.0003454565 0.0002205181
#> start:Inactive_50 0.0006336680 0.0004231760 0.0002763735 0.0001764198
#> start:Retired_50  0.0000000000 0.0000000000 0.0000000000 0.0000000000
#> AVERAGE           0.0007033139 0.0004696868 0.0003067494 0.0001958099
#> AVERAGE(COND.)    0.0007411389 0.0004949471 0.0003232468 0.0002063408
#>                           38.5         39.5         40.5         41.5
#> start:Employed_50 0.0001374813 8.362788e-05 4.956649e-05 2.857676e-05
#> start:Inactive_50 0.0001099883 6.690432e-05 3.965439e-05 2.286210e-05
#> start:Retired_50  0.0000000000 0.000000e+00 0.000000e+00 0.000000e+00
#> AVERAGE           0.0001220771 7.425771e-05 4.401276e-05 2.537485e-05
#> AVERAGE(COND.)    0.0001286425 7.825137e-05 4.637982e-05 2.673953e-05
#>                           42.5         43.5         44.5         45.5
#> start:Employed_50 1.599180e-05 8.663770e-06 4.529845e-06 2.277371e-06
#> start:Inactive_50 1.279383e-05 6.931225e-06 3.623985e-06 1.821952e-06
#> start:Retired_50  0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#> AVERAGE           1.419999e-05 7.693029e-06 4.022294e-06 2.022201e-06
#> AVERAGE(COND.)    1.496368e-05 8.106769e-06 4.238617e-06 2.130957e-06
#>                           46.5         47.5 TOTAL(RESCALED)
#> start:Employed_50 1.096292e-06 5.029110e-07               1
#> start:Inactive_50 8.770597e-07 4.023409e-07               1
#> start:Retired_50  0.000000e+00 0.000000e+00               1
#> AVERAGE           9.734565e-07 4.465618e-07               1
#> AVERAGE(COND.)    1.025810e-06 4.705784e-07               1

### Last exit
  
# Leaving employment to any state
dtms_last(dtms=hrs,
          matrix=Tm,
          risk="Employed",
          start_distr=Sm)  
#>                          0.5         1.5         2.5        3.5        4.5
#> start:Employed_50 0.01291835 0.015580579 0.018434340 0.02139079 0.02435743
#> start:Inactive_50 0.00000000 0.003371499 0.007140171 0.01120009 0.01542956
#> start:Retired_50  0.00000000 0.004411954 0.008670299 0.01289087 0.01707953
#> AVERAGE           0.01084699 0.013668878 0.016690956 0.01983143 0.02299875
#> AVERAGE(COND.)    0.00000000 0.003657972 0.007561468 0.01166562 0.01588385
#>                          5.5        6.5        7.5        8.5        9.5
#> start:Employed_50 0.02724656 0.02998277 0.03250793 0.03478312 0.03678717
#> start:Inactive_50 0.01970090 0.02389164 0.02789427 0.03162265 0.03501429
#> start:Retired_50  0.02118723 0.02514327 0.02887598 0.03232469 0.03544493
#> AVERAGE           0.02610229 0.02906136 0.03181151 0.03430735 0.03652191
#> AVERAGE(COND.)    0.02011014 0.02423626 0.02816457 0.03181595 0.03513286
#>                         10.5       11.5       12.5       13.5       14.5
#> start:Employed_50 0.03851244 0.03995856 0.04112541 0.04200666 0.04258530
#> start:Inactive_50 0.03802828 0.04063999 0.04283353 0.04459409 0.04590179
#> start:Retired_50  0.03820815 0.04059747 0.04260126 0.04420621 0.04539197
#> AVERAGE           0.03844275 0.04006595 0.04138904 0.04240441 0.04309457
#> AVERAGE(COND.)    0.03807781 0.04062828 0.04276958 0.04448729 0.04576142
#>                         15.5       16.5       17.5       18.5       19.5
#> start:Employed_50 0.04283249 0.04271072 0.04218158 0.04121663 0.03980825
#> start:Inactive_50 0.04672902 0.04704261 0.04681104 0.04601525 0.04465953
#> start:Retired_50  0.04612909 0.04638159 0.04611457 0.04530529 0.04395419
#> AVERAGE           0.04343078 0.04337612 0.04289313 0.04195471 0.04055498
#> AVERAGE(COND.)    0.04656384 0.04686061 0.04661927 0.04581978 0.04446533
#>                         20.5       21.5       22.5       23.5       24.5
#> start:Employed_50 0.03797653 0.03576951 0.03325718 0.03052279 0.02765492
#> start:Inactive_50 0.04277797 0.04043395 0.03771322 0.03471442 0.03154096
#> start:Retired_50  0.04209175 0.03977806 0.03709604 0.03414196 0.03101715
#> AVERAGE           0.03871611 0.03648846 0.03394443 0.03116961 0.02825489
#> AVERAGE(COND.)    0.04258903 0.04025336 0.03754329 0.03455680 0.03139673
#>                         25.5       26.5       27.5       28.5       29.5
#> start:Employed_50 0.02474178 0.02186686 0.01910473 0.01651703 0.01414939
#> start:Inactive_50 0.02829525 0.02507424 0.02196493 0.01903980 0.01635323
#> start:Retired_50  0.02782218 0.02465228 0.02159291 0.01871528 0.01607276
#> AVERAGE           0.02529067 0.02236251 0.01954691 0.01690721 0.01449037
#> AVERAGE(COND.)    0.02816500 0.02495806 0.02186250 0.01895045 0.01627601
#>                         30.5       31.5        32.5        33.5        34.5
#> start:Employed_50 0.01202984 0.01016928 0.008563551 0.007196734 0.006044947
#> start:Inactive_50 0.01393962 0.01181371 0.009972878 0.008400795 0.007071706
#> start:Retired_50  0.01369908 0.01160864 0.009798767 0.008253337 0.006946957
#> AVERAGE           0.01232544 0.01042390 0.008781839 0.007383287 0.006204073
#> AVERAGE(COND.)    0.01387339 0.01175725 0.009924939 0.008360195 0.007037359
#>                          35.5        36.5        37.5        38.5        39.5
#> start:Employed_50 0.005080014 0.004272634 0.003594783 0.003021334 0.002530984
#> start:Inactive_50 0.005954619 0.005016937 0.004227251 0.003557253 0.002982842
#> start:Retired_50  0.005849104 0.004927689 0.004151801 0.003493588 0.002929341
#> AVERAGE           0.005215592 0.004388038 0.003692864 0.003104454 0.002601075
#> AVERAGE(COND.)    0.005925567 0.004992364 0.004206477 0.003539724 0.002968112
#>                          40.5        41.5        42.5        43.5         44.5
#> start:Employed_50 0.002106631 0.001735359 0.001408161 0.001119468 0.0008665077
#> start:Inactive_50 0.002484618 0.002047906 0.001662483 0.001322055 0.0010235392
#> start:Retired_50  0.002439977 0.002011065 0.001632547 0.001298233 0.0010050876
#> AVERAGE           0.002165268 0.001783847 0.001447618 0.001150900 0.0008908719
#> AVERAGE(COND.)    0.002472327 0.002037762 0.001654240 0.001315496 0.0010184588
#>                           45.5         46.5         47.5         48.5
#> start:Employed_50 0.0006484851 0.0004656015 0.0003179799 0.0003399001
#> start:Inactive_50 0.0007661215 0.0005501196 0.0003757276 0.0004016478
#> start:Retired_50  0.0007523058 0.0005401968 0.0003689494 0.0003944012
#> AVERAGE           0.0006667373 0.0004787152 0.0003269401 0.0003494809
#> AVERAGE(COND.)    0.0007623176 0.0005473875 0.0003738613 0.0003996526
#>                   TOTAL(RESCALED)
#> start:Employed_50               1
#> start:Inactive_50               1
#> start:Retired_50                1
#> AVERAGE                         1
#> AVERAGE(COND.)                  1
  
dtms_last(dtms=hrs,
          matrix=Tw,
          risk="Employed",
          start_distr=Sw)  
#>                          0.5         1.5         2.5        3.5        4.5
#> start:Employed_50 0.01766177 0.020606372 0.023546845 0.02637180 0.02898568
#> start:Inactive_50 0.00000000 0.003706821 0.007803532 0.01212352 0.01650168
#> start:Retired_50  0.00000000 0.005502539 0.010469831 0.01510148 0.01944428
#> AVERAGE           0.01235732 0.015603072 0.018925823 0.02221233 0.02535466
#> AVERAGE(COND.)    0.00000000 0.003947324 0.008160634 0.01252236 0.01689579
#>                          5.5        6.5        7.5        8.5        9.5
#> start:Employed_50 0.03131736 0.03332488 0.03499567 0.03634260 0.03739700
#> start:Inactive_50 0.02078614 0.02484968 0.02859746 0.03196965 0.03493880
#> start:Retired_50  0.02347794 0.02716260 0.03046441 0.03336704 0.03587384
#> AVERAGE           0.02826274 0.03087252 0.03314916 0.03508546 0.03669633
#> AVERAGE(COND.)    0.02114666 0.02515945 0.02884750 0.03215681 0.03506403
#>                         10.5       11.5       12.5       13.5       14.5
#> start:Employed_50 0.03819981 0.03879233 0.03920768 0.03946372 0.03955845
#> start:Inactive_50 0.03750287 0.03967545 0.04147494 0.04291420 0.04399239
#> start:Retired_50  0.03800373 0.03978363 0.04123934 0.04238689 0.04322572
#> AVERAGE           0.03801064 0.03906191 0.03987914 0.04047881 0.04085928
#> AVERAGE(COND.)    0.03756995 0.03968994 0.04144338 0.04284358 0.04388971
#>                         15.5       16.5       17.5       18.5       19.5
#> start:Employed_50 0.03946854 0.03915205 0.03855622 0.03763004 0.03633946
#> start:Inactive_50 0.04469053 0.04497239 0.04479181 0.04410621 0.04289353
#> start:Retired_50  0.04373539 0.04387718 0.04360175 0.04286270 0.04163339
#> AVERAGE           0.04099847 0.04085605 0.04038111 0.03952504 0.03825719
#> AVERAGE(COND.)    0.04456261 0.04482571 0.04463242 0.04393966 0.04272476
#>                         20.5       21.5       22.5       23.5       24.5
#> start:Employed_50 0.03468067 0.03268591 0.03041890 0.02796231 0.02540353
#> start:Inactive_50 0.04116685 0.03898024 0.03642243 0.03360158 0.03062879
#> start:Retired_50  0.03992151 0.03777513 0.03527691 0.03252935 0.02963867
#> AVERAGE           0.03657861 0.03452784 0.03217589 0.02961286 0.02693303
#> AVERAGE(COND.)    0.04100006 0.03881883 0.03626901 0.03345798 0.03049618
#>                         25.5       26.5       27.5       28.5       29.5
#> start:Employed_50 0.02282467 0.02029800 0.01788423 0.01563151 0.01357437
#> start:Inactive_50 0.02760700 0.02462635 0.02176283 0.01907723 0.01661393
#> start:Retired_50  0.02670374 0.02381134 0.02103463 0.01843209 0.01604633
#> AVERAGE           0.02422464 0.02156517 0.01901982 0.01664043 0.01446442
#> AVERAGE(COND.)    0.02748602 0.02451719 0.02166530 0.01899083 0.01653791
#>                         30.5       31.5        32.5        33.5        34.5
#> start:Employed_50 0.01173313 0.01011452 0.008713357 0.007515165 0.006499179
#> start:Inactive_50 0.01440016 0.01244655 0.010749127 0.009292380 0.008052821
#> start:Retired_50  0.01390336 0.01201316 0.010371606 0.008963445 0.007765757
#> AVERAGE           0.01251415 0.01079748 0.009309585 0.008035694 0.006954245
#> AVERAGE(COND.)    0.01433362 0.01238851 0.010698565 0.009248325 0.008014374
#>                          35.5        36.5        37.5        38.5        39.5
#> start:Employed_50 0.005641221 0.004916184 0.004299891 0.003770342 0.003308422
#> start:Inactive_50 0.007002480 0.006111920 0.005352539 0.004698133 0.004125805
#> start:Retired_50  0.006751333 0.005891584 0.005158764 0.004527478 0.003975551
#> AVERAGE           0.006039953 0.005266443 0.004608243 0.004042126 0.003547867
#> AVERAGE(COND.)    0.006968844 0.006082410 0.005326586 0.004675277 0.004105682
#>                          40.5        41.5        42.5        43.5        44.5
#> start:Employed_50 0.002898198 0.002526968 0.002185195 0.001866385 0.001566972
#> start:Inactive_50 0.003616389 0.003154556 0.002728767 0.002331175 0.001957504
#> start:Retired_50  0.003484430 0.003039283 0.002628950 0.002245840 0.001885811
#> AVERAGE           0.003108588 0.002710818 0.002344434 0.002002545 0.001681379
#> AVERAGE(COND.)    0.003598716 0.003139117 0.002715398 0.002319746 0.001947902
#>                          45.5        46.5         47.5        48.5
#> start:Employed_50 0.001286155 0.001025612 0.0007889586 0.001061766
#> start:Inactive_50 0.001606872 0.001281452 0.0009858132 0.001326732
#> start:Retired_50  0.001548000 0.001234492 0.0009496812 0.001278100
#> AVERAGE           0.001380109 0.001100561 0.0008466276 0.001139388
#> AVERAGE(COND.)    0.001598987 0.001275162 0.0009809740 0.001320219
#>                   TOTAL(RESCALED)
#> start:Employed_50               1
#> start:Inactive_50               1
#> start:Retired_50                1
#> AVERAGE                         1
#> AVERAGE(COND.)                  1
  
# Leaving employment for retirement
dtms_last(dtms=hrs,
          matrix=Tm,
          risk="Employed",
          risk_to="Retired",
          start_distr=Sm)  
#>                           0.5         1.5         2.5         3.5         4.5
#> start:Employed_50 0.006375089 0.007557275 0.008950002 0.010566800 0.012419250
#> start:Inactive_50 0.000000000 0.001548883 0.003283356 0.005240252 0.007451288
#> start:Retired_50  0.000000000 0.002041386 0.004015522 0.006074512 0.008307155
#> AVERAGE           0.005307157 0.006573369 0.008034340 0.009712795 0.011626306
#> AVERAGE(COND.)    0.000000000 0.001683786 0.003483906 0.005468767 0.007685722
#>                           5.5        6.5        7.5        8.5        9.5
#> start:Employed_50 0.014515540 0.01685932 0.01944866 0.02227478 0.02532010
#> start:Inactive_50 0.009940801 0.01272413 0.01580626 0.01918037 0.02282592
#> start:Retired_50  0.010767334 0.01348660 0.01647970 0.01974657 0.02327211
#> AVERAGE           0.013787121 0.01620159 0.01886940 0.02178239 0.02492276
#> AVERAGE(COND.)    0.010167199 0.01293298 0.01599072 0.01933546 0.02294813
#>                         10.5       11.5       12.5       13.5       14.5
#> start:Employed_50 0.02855513 0.03193389 0.03538830 0.03882244 0.04210882
#> start:Inactive_50 0.02670568 0.03076164 0.03490980 0.03903516 0.04298895
#> start:Retired_50  0.02702412 0.03094949 0.03496910 0.03897270 0.04281588
#> AVERAGE           0.02825993 0.03174614 0.03531087 0.03885521 0.04224831
#> AVERAGE(COND.)    0.02679290 0.03081309 0.03492604 0.03901805 0.04294154
#>                         15.5       16.5       17.5       18.5       19.5
#> start:Employed_50 0.04508955 0.04758550 0.04941484 0.05041948 0.05049324
#> start:Inactive_50 0.04659113 0.04964130 0.05193937 0.05331404 0.05365228
#> start:Retired_50  0.04632229 0.04929421 0.05153297 0.05286731 0.05318301
#> AVERAGE           0.04532876 0.04791396 0.04981909 0.05088387 0.05100090
#> AVERAGE(COND.)    0.04651749 0.04954623 0.05182805 0.05319167 0.05352374
#>                         20.5       21.5       22.5       23.5       24.5
#> start:Employed_50 0.04960260 0.04779266 0.04517694 0.04191688 0.03819919
#> start:Inactive_50 0.05292041 0.05116917 0.04852202 0.04515319 0.04126392
#> start:Retired_50  0.05244434 0.05069958 0.04806970 0.04472657 0.04086920
#> AVERAGE           0.05013655 0.04833674 0.04571654 0.04243944 0.03869447
#> AVERAGE(COND.)    0.05279001 0.05104054 0.04839812 0.04503634 0.04115580
#>                         25.5       26.5       27.5       28.5       29.5
#> start:Employed_50 0.03421638 0.03015133 0.02616534 0.02238924 0.01891838
#> start:Inactive_50 0.03706213 0.03274626 0.02849241 0.02444464 0.02070922
#> start:Retired_50  0.03670343 0.03242572 0.02821040 0.02420005 0.02049979
#> AVERAGE           0.03467663 0.03057132 0.02654222 0.02272233 0.01920877
#> AVERAGE(COND.)    0.03696388 0.03265846 0.02841516 0.02437764 0.02065186
#>                         30.5       31.5       32.5        33.5        34.5
#> start:Employed_50 0.01581160 0.01309407 0.01076293 0.008794522 0.007151957
#> start:Inactive_50 0.01735325 0.01440737 0.01187164 0.009723241 0.007924475
#> start:Retired_50  0.01717592 0.01425864 0.01174790 0.009620969 0.007840424
#> AVERAGE           0.01606172 0.01330724 0.01094298 0.008945405 0.007277510
#> AVERAGE(COND.)    0.01730468 0.01436663 0.01183775 0.009695227 0.007901452
#>                          35.5        36.5        37.5        38.5        39.5
#> start:Employed_50 0.005791902 0.004670103 0.003745280 0.002981487 0.002349137
#> start:Inactive_50 0.006430195 0.005193776 0.004171417 0.003324779 0.002622184
#> start:Retired_50  0.006361480 0.005137910 0.004126299 0.003288655 0.002593590
#> AVERAGE           0.005895674 0.004755263 0.003814595 0.003037336 0.002393565
#> AVERAGE(COND.)    0.006411373 0.005178474 0.004159059 0.003314884 0.002614352
#>                          40.5        41.5        42.5         43.5         44.5
#> start:Employed_50 0.001825025 0.001391633 0.001036018 0.0007484885 0.0005212742
#> start:Inactive_50 0.002038702 0.001555462 0.001158474 0.0008372148 0.0005831928
#> start:Retired_50  0.002016408 0.001538417 0.001145760 0.0008280160 0.0005767800
#> AVERAGE           0.001859796 0.001418295 0.001055948 0.0007629295 0.0005313523
#> AVERAGE(COND.)    0.002032595 0.001550793 0.001154991 0.0008346951 0.0005814362
#>                           45.5         46.5         47.5 48.5 TOTAL(RESCALED)
#> start:Employed_50 0.0003473650 0.0002196661 0.0001305937    0               1
#> start:Inactive_50 0.0003886848 0.0002458214 0.0001461536    0               1
#> start:Retired_50  0.0003844085 0.0002431159 0.0001445446    0               1
#> AVERAGE           0.0003540905 0.0002239234 0.0001331264    0               1
#> AVERAGE(COND.)    0.0003875135 0.0002450804 0.0001457129    0               1
  
dtms_last(dtms=hrs,
          matrix=Tw,
          risk="Employed",
          risk_to="Retired",
          start_distr=Sw)  
#>                           0.5         1.5         2.5         3.5         4.5
#> start:Employed_50 0.007327389 0.008466725 0.009762925 0.011220423 0.012844511
#> start:Inactive_50 0.000000000 0.001390562 0.002954018 0.004709480 0.006676318
#> start:Retired_50  0.000000000 0.002097173 0.004026653 0.005960000 0.007992510
#> AVERAGE           0.004987450 0.006236821 0.007633809 0.009193964 0.010930276
#> AVERAGE(COND.)    0.000000000 0.001483908 0.003095718 0.004874679 0.006850192
#>                           5.5        6.5        7.5        8.5        9.5
#> start:Employed_50 0.014640929 0.01661559 0.01877426 0.02112187 0.02366097
#> start:Inactive_50 0.008872217 0.01131208 0.01400718 0.01696403 0.02018267
#> start:Retired_50  0.010181241 0.01256249 0.01515998 0.01798835 0.02105382
#> AVERAGE           0.012853963 0.01497471 0.01730057 0.01983731 0.02258696
#> AVERAGE(COND.)    0.009045144 0.01147727 0.01415947 0.01709935 0.02029775
#>                         10.5       11.5       12.5       13.5       14.5
#> start:Employed_50 0.02638871 0.02929189 0.03233992 0.03547622 0.03860958
#> start:Inactive_50 0.02365354 0.02735256 0.03123405 0.03522209 0.03920198
#> start:Retired_50  0.02435233 0.02786526 0.03155273 0.03534501 0.03913409
#> AVERAGE           0.02554474 0.02869421 0.03200022 0.03540025 0.03879589
#> AVERAGE(COND.)    0.02374585 0.02742029 0.03127615 0.03523833 0.03919301
#>                         15.5       16.5       17.5       18.5       19.5
#> start:Employed_50 0.04160846 0.04430228 0.04649378 0.04798477 0.04861182
#> start:Inactive_50 0.04301509 0.04646140 0.04931441 0.05135032 0.05238777
#> start:Retired_50  0.04276819 0.04605402 0.04877100 0.05069972 0.05166097
#> AVERAGE           0.04204724 0.04497459 0.04737160 0.04903208 0.04978698
#> AVERAGE(COND.)    0.04298248 0.04640759 0.04924262 0.05126438 0.05229176
#>                         20.5       21.5       22.5       23.5       24.5
#> start:Employed_50 0.04828243 0.04699738 0.04484951 0.04200003 0.03864476
#> start:Inactive_50 0.05232678 0.05117199 0.04902953 0.04607984 0.04254036
#> start:Retired_50  0.05155441 0.05038210 0.04824607 0.04532201 0.04182275
#> AVERAGE           0.04954138 0.04829718 0.04615131 0.04327091 0.03985851
#> AVERAGE(COND.)    0.05222475 0.05106764 0.04892603 0.04597973 0.04244556
#>                         25.5       26.5       27.5       28.5       29.5
#> start:Employed_50 0.03498425 0.03120422 0.02746461 0.02389356 0.02058446
#> start:Inactive_50 0.03863330 0.03456487 0.03051359 0.02662379 0.02300207
#> start:Retired_50  0.03796622 0.03395480 0.02996369 0.02613435 0.02257111
#> AVERAGE           0.03612140 0.03225168 0.02841508 0.02474478 0.02133832
#> AVERAGE(COND.)    0.03854518 0.03448427 0.03044095 0.02655913 0.02294514
#>                         30.5       31.5       32.5       33.5        34.5
#> start:Employed_50 0.01759603 0.01495526 0.01266271 0.01069912 0.009032352
#> start:Inactive_50 0.01971709 0.01680244 0.01426228 0.01207845 0.010217983
#> start:Retired_50  0.01934095 0.01647644 0.01398120 0.01183700 0.010011139
#> AVERAGE           0.01825751 0.01553139 0.01316166 0.01112941 0.009402247
#> AVERAGE(COND.)    0.01966740 0.01675937 0.01422515 0.01204655 0.010190658
#>                          35.5        36.5        37.5        38.5        39.5
#> start:Employed_50 0.007623619 0.006432573 0.005421012 0.004555236 0.003807272
#> start:Inactive_50 0.008640018 0.007301447 0.006161090 0.005182391 0.004334873
#> start:Retired_50  0.008463205 0.007150656 0.006032897 0.005073922 0.004243728
#> AVERAGE           0.007940738 0.006703679 0.005651942 0.004750937 0.003971912
#> AVERAGE(COND.)    0.008616660 0.007281527 0.006144155 0.005168061 0.004322832
#>                          40.5        41.5        42.5        43.5        44.5
#> start:Employed_50 0.003155235 0.002583091 0.002079993 0.001639358 0.001257725
#> start:Inactive_50 0.003594626 0.002944102 0.002371444 0.001869486 0.001434504
#> start:Retired_50  0.003518785 0.002881829 0.002321193 0.001829820 0.001404041
#> AVERAGE           0.003292351 0.002695749 0.002170946 0.001711174 0.001312893
#> AVERAGE(COND.)    0.003584607 0.002935875 0.002364806 0.001864246 0.001430480
#>                           45.5         46.5         47.5 48.5 TOTAL(RESCALED)
#> start:Employed_50 0.0009334909 0.0006655697 0.0004521362    0               1
#> start:Inactive_50 0.0010648114 0.0007592548 0.0005158037    0               1
#> start:Retired_50  0.0010421853 0.0007431149 0.0005048359    0               1
#> AVERAGE           0.0009744725 0.0006948063 0.0004720052    0               1
#> AVERAGE(COND.)    0.0010618224 0.0007571227 0.0005143548    0               1
```
